<!DOCTYPE html>
<html lang="en">
<head>
  <title>YaCy '#[clientname]#': Blacklist Administration</title>
  #%env/templates/header-backend.template%#
  <script type="text/javascript" src="/js/yaml/tablesorter/jquery.tablesorter.min.js"></script>
  #(disabled)##(edit)#
  <script type="text/javascript">
  function switchTargetBlacklist(value){
    if (value == "moveBlacklistEntry") {
      document.getElementById("editBlacklistPatterns").targetBlacklist.disabled=false;
    } else {
      document.getElementById("editBlacklistPatterns").targetBlacklist.disabled=true;
    }
  }
  </script>
  ::#(/edit)#::#(/disabled)#
</head>

<body id="blacklist"#(disabled)##(edit)# onload="switchTargetBlacklist('');"::#(/edit)#::#(/disabled)#>
  #%env/templates/page-start.template%#

  <div id="devInfo">
   Code:
   - provide shared state of active blacklist on template top-level
 </div>

 <h1>Blacklist Administration</h1>
 <p>
  This function provides an <abbr>URL</abbr> filter to the proxy; any blacklisted <abbr>URL</abbr> is blocked from being loaded. You can define several blacklists and activate them separately.
  You may also provide your blacklist to other peers by sharing them; in return you may collect blacklist entries from other peers.
</p>

<form action="Blacklist_p.html#blacklistSelect" method="post" enctype="multipart/form-data" accept-charset="UTF-8">
  <fieldset>
    <legend>Create new list:</legend>
    #(error)#
    ::
    <p>
      Unable to create list <strong>#[name]#</strong> since it contains illegal characters.
      A legal name is made up from a letter, digit, minus, plus or underscore as the first character followed by letters, digits, minus, plus, underscores or dots.
    </p>
    ::
    <p>
      Unable to create list <strong>#[name]#</strong> since a list of this name exists already.
    </p>
    #(/error)#

    <fieldset class="formSection">
      <legend>Name</legend>
      <input type="text" id="newListName" name="newListName"/>
    </fieldset>

    <fieldset class="formControl">
      <div class="content">
        <button type="submit" name="createNewList" class="primary icon-run">create</button>
      </div>
    </fieldset>
  </fieldset>
</form>

<h2>
  Active list: #(disabled)#<em>#[currentBlacklist]#</em>::<span class="error">No blacklist selected</span>#(/disabled)#
</h2>
<p>
  Used Blacklist engine: <span class="settingsValue">#[blacklistEngine]#</span>
</p>

<fieldset class="main">
  <legend>Blacklist editor</legend>
  #(disabled)#

  <fieldset class="formGroup" id="blacklistSelect">
    <legend>Select blacklist</legend>
    <fieldset class="formSection">
      <legend>List name</legend>
      <div class="content">
        <form action="Blacklist_p.html#blacklistSelect" method="post" enctype="multipart/form-data" accept-charset="UTF-8">
          <input type="hidden" name="selectList" value="select" />
          <select name="selectedListName" size="1" onchange="$(this).closest('form').submit();">
            #{blackLists}#
            <option value="#[name]#" #(selected)#::selected="selected"#(/selected)#>#[name]# [#(shared)#not shared::shared#(/shared)#]</option>
            #{/blackLists}#
          </select>
        </form>
      </div>
    </fieldset>
    <fieldset class="formSection">
      <legend>Delete / Share</legend>
      <div class="content">
        <form action="Blacklist_p.html#blacklistSelect" method="post" enctype="multipart/form-data" accept-charset="UTF-8">
          <input type="hidden" name="selectedListName" value="#[currentBlacklist]#" />
          <button type="submit" name="deleteList" class="icon-delete">Delete this list</button>
          <button type="submit" name="shareList" class="icon-run">Toggle sharing of this list</button>
        </form>
      </div>
    </fieldset>
  </fieldset>
  ::
  #(/disabled)#

  #(disabled)#
  #(edit)#
  <fieldset class="formGroup" id="blacklistEdit">
    <legend>Edit blacklist</legend>
    <form action="Blacklist_p.html#blacklistEdit" method="post" enctype="multipart/form-data" accept-charset="UTF-8">
      <fieldset class="formSection">
        <legend>Add pattern</legend>
        <div class="content">
          <input type="text" name="newEntry" size="50" />
        </div>
        <div class="formHelp">
          <p>
            The right <code>*</code>, after the <code>/</code>, can be replaced by a <a href="http://docs.oracle.com/javase/1.5.0/docs/api/java/util/regex/Pattern.html" target="_blank">regex</a>.
          </p>
          <ul>
            <li>domain.net/fullpath</li>
            <li>domain.net/*</li>
            <li>*.domain.net/*</li>
            <li>*.sub.domain.net/*</li>
            <li>sub.domain.*/*</li>
            <li>domain.*/*</li>
            <li>
              a complete <a href="http://docs.oracle.com/javase/1.5.0/docs/api/java/util/regex/Pattern.html" target="_blank">regex</a> (slow)
            </li>
          </ul>
        </div>
      </fieldset>
      <fieldset class="formControl">
        <input type="hidden" name="currentBlacklist" value="#[currentBlacklist]#" />
        <div class="content">
          <button type="submit" name="addBlacklistEntry" class="icon-run">Add URL pattern</button>
        </div>
      </fieldset>
    </form>

    <fieldset class="formSection" id="blacklistPatterns">
      <legend>Defined patterns</legend>
      <div class="content">
        <form id="editBlacklistPatterns" action="Blacklist_p.html#blacklistPatterns" method="post" enctype="multipart/form-data">
          <input type="hidden" name="currentBlacklist" value="#[currentBlacklist]#" />
          <table class="sortable">
            <thead>
              <tr>
                <th>
                  <input type="checkbox" data-action="checkAllToggle"/>
                </th>
                <th>Blacklist pattern</th>
              </tr>
            </thead>
            <tbody>
              #{Itemlist}#
              <tr>
                <td>
                  <input type="checkbox" name="selectedEntry.#[count]#" id="selectedEntry.#[count]#" value="#[item]#" />
                </td>
                <td>
                  <label for="selectedEntry.#[count]#">#[item]#</label>
                </td>
              </tr>
              #{/Itemlist}#
            </tbody>
          </table>
          <p>
            <select name="action" size="1" onchange="switchTargetBlacklist(this.value);">
              <option value="editBlacklistEntry">Edit selected pattern(s)</option>
              <option value="deleteBlacklistEntry">Delete selected pattern(s)</option>
              <option value="moveBlacklistEntry">Move selected pattern(s) to</option>
            </select>
            <select name="targetBlacklist" size="1">
              #{blackListsMove}#
              <option value="#[name]#">#[name]#</option>
              #{/blackListsMove}#
            </select>
            <button type="submit" class="icon-run">Submit</button>
          </p>
        </form>
        <hr/>
        <form id="blacklistSelectRange" action="Blacklist_p.html#blacklistSelectRange" method="post">
          <input type="hidden" name="currentBlacklist" value="#[currentBlacklist]#" />
          <input type="hidden" name="action" value="selectRange" />
          <fieldset class="formSection">
            <label for="rangeOffset">Show entries</label>:
            <select name="offset" id="rangeOffset" size="1" onchange="document.selectRange.submit();">
              #{subListOffset}#
              <option value="#[value]#" #(selected)#::selected="selected"#(/selected)#>#[fvalue]# - #[tvalue]#</option>
              #{/subListOffset}#
            </select>
            <label for="rangeSize">Entries per page</label>:
            <select name="size" size="1" id="rangeSize" onchange="document.selectRange.submit();">
              #{subListSize}#
              <option value="#[value]#" #(selected)#::selected="selected"#(/selected)#>#[text]#</option>
              #{/subListSize}#
            </select>
            <button type="submit" class="icon-run">Go</button>
          </fieldset>
        </form>
      </div>
      <div class="formHelp">
        <p>
          These are the domain name/path patterns in <strong><em>#[currentBlacklist]#</em></strong>.
        </p>
      </div>
    </fieldset>
  </fieldset>
  ::
  <fieldset class="formGroup" id="blacklistPatternEdit">
    <legend>Pattern editor</legend>
    <div class="content noIndent">
      <form name="editBlacklistEntry" action="Blacklist_p.html#blacklistPatternEdit" method="post" enctype="multipart/form-data">
        <div>
          <input type="hidden" name="currentBlacklist" value="#[currentBlacklist]#" />
          <input type="hidden" name="action" value="editBlacklistEntry" />
          #{editList}#
          <input type="text" name="editedBlacklistEntry.#[count]#" size="50" value="#[item]#"/>
          <input type="hidden" name="selectedBlacklistEntry.#[count]#" value="#[item]#"/>
          #{/editList}#
          <br /><br />
          <input type="submit" value="Save URL pattern(s)" />
        </div>
      </form>
    </div>
  </fieldset>
  #(/edit)#

  <fieldset class="formGroup" id="blacklistSettings">
    <legend>Settings</legend>
    <form action="Blacklist_p.html#blacklistSettings" method="post" enctype="multipart/form-data" accept-charset="UTF-8">
      <input type="hidden" name="selectedListName" value="#[currentBlacklist]#" />
      <fieldset class="formSection">
        <legend>Activate this list for&hellip;</legend>
        <div class="content">
          #{currentActiveFor}#
          <div>
            <input type="checkbox" id="activateList4#[blTypeName]#" name="activateList4#[blTypeName]#" value="on" #(checked)#checked="checked"::#(/checked)# />
            <label for="activateList4#[blTypeName]#">#[blTypeName]#</label>
          </div>
          #{/currentActiveFor}#
          <br/>
          <button type="submit" name="activateList" class="icon-run">Save</button>
        </div>
      </fieldset>
    </form>
  </fieldset>
</fieldset>
::#(/disabled)#

#%env/templates/page-end.template%#
</body>
</html>
