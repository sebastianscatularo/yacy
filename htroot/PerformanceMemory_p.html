<!DOCTYPE html>
<html lang="en">
<head>
  <title>YaCy '#[clientname]#': Performance Settings for Memory</title>
  #%env/templates/header-backend.template%#
  <script type="text/javascript" src="/js/yaml/pages/performanceMemory.js"></script>
</head>

<body id="performanceMemory">
  #%env/templates/page-start.template%#

  <div id="devInfo" data-done="html script"></div>

  <h1>Performance Settings for Memory</h1>

  <fieldset class="framed" style="width:600px;">
    <legend class="light">Performance Graph</legend>
    <img src="PerformanceGraph.png?nopeers=" id="graph" alt="Performance Graph"/>
    <input type="checkbox" id="autoReload" checked="checked"/>
    <label for="autoReload">Auto refresh graph</label>
  </fieldset>

  <form action="PerformanceMemory_p.html" method="post" enctype="multipart/form-data" accept-charset="UTF-8">
    <fieldset>
      <legend>Options</legend>
      <fieldset class="formSection">
        <legend>Short Memory</legend>
        <div class="content">
          <input type="checkbox" name="simulatedshortmemory" id="simulatedshortmemory" #(simulatedshortmemory.checked)#:: checked="checked"#(/simulatedshortmemory.checked)#/>
          <label for="simulatedshortmemory">Simulate short memory status</label>
        </div>
      </fieldset>
      <fieldset class="formSection">
        <legend>Strategy</legend>
        <div class="content">
          <p>
            <input type="checkbox" name="useStandardmemoryStrategy" #(useStandardmemoryStrategy.checked)#:: checked="checked"#(/useStandardmemoryStrategy.checked)# id="useStandardmemoryStrategy"/>
            <label for="useStandardmemoryStrategy">Use Standard Memory Strategy.</label>
          </p>
          <p>
            <s class="sym sym-hint"></s>
            Current: <em>#[memoryStrategy]#</em>
          </p>
        </div>
      </fieldset>
      <fieldset class="formControl">
        <div class="content">
          <button type="submit" class="primary icon-run">Update</button>
        </div>
      </fieldset>
    </fieldset>
    <p></p>
    <p></p>
  </form>

  <h2>Memory Usage</h2>
  <table class="multiBody">
    <thead>
      <tr>
        <th rowspan="2">Type</th>
        <th rowspan="2">After Startup</th>
        <th colspan="2">After Initializations</th>
        <th rowspan="2">
          Now #(gc)#before <a href="PerformanceMemory_p.html?gc=">GC</a>::after <abbr>GC</abbr>#(/gc)#
        </th>
      </tr>
      <tr>
        <th>before <abbr>GC</abbr></th>
        <th>after <abbr>GC</abbr></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Max</td>
        <td colspan="4">#[memoryMax]# MByte</td>
      </tr>
      <tr>
        <td></td>
        <td colspan="4"><em>Description:</em> Maximum memory that the JVM will attempt to use.</td>
      </tr>
    </tbody>
    <tbody>
      <tr>
        <td>Available</td>
        <td>#[memoryAvailAfterStartup]# MByte</td>
        <td>#[memoryAvailAfterInitBGC]# MByte</td>
        <td>#[memoryAvailAfterInitAGC]# MByte</td>
        <td>#[memoryAvailNow]# MByte</td>
      </tr>
      <tr>
        <td></td>
        <td colspan="4"><em>Description:</em> Total available memory including free for the JVM within maximum.</td>
      </tr>
    </tbody>
    <tbody>
      <tr>
        <td>Total</td>
        <td>#[memoryTotalAfterStartup]# KByte</td>
        <td>#[memoryTotalAfterInitBGC]# KByte</td>
        <td>#[memoryTotalAfterInitAGC]# KByte</td>
        <td>#[memoryTotalNow]# MByte</td>
      </tr>
      <tr>
        <td></td>
        <td colspan="4"><em>Description:</em> Total memory taken from the <abbr>OS</abbr>.</td>
      </tr>
    </tbody>
    <tbody>
      <tr>
        <td>Free</td>
        <td>#[memoryFreeAfterStartup]# KByte</td>
        <td>#[memoryFreeAfterInitBGC]# KByte</td>
        <td>#[memoryFreeAfterInitAGC]# KByte</td>
        <td>#[memoryFreeNow]# MByte</td>
      </tr>
      <tr>
        <td></td>
        <td colspan="4"><em>Description:</em> Free memory in the JVM within total amount.</td>
      </tr>
    </tbody>
    <tbody>
      <tr>
        <td>Used</td>
        <td>#[memoryUsedAfterStartup]# KByte</td>
        <td>#[memoryUsedAfterInitBGC]# KByte</td>
        <td>#[memoryUsedAfterInitAGC]# KByte</td>
        <td>#[memoryUsedNow]# MByte</td>
      </tr>
      <tr>
        <td></td>
        <td colspan="4"><em>Description:</em> Used memory in the JVM within total amount.</td>
      </tr>
    </tbody>
  </table>

  <h2>Table RAM Index</h2>
  <table>
    <thead>
      <tr>
        <th rowspan="2">Table</th>
        <th rowspan="2">Size</th>
        <th colspan="2">Key</th>
        <th colspan="2">Value</th>
      </tr>
      <tr>
        <th>Chunk Size</th>
        <th>Used Memory</th>
        <th>Chunk Size</th>
        <th>Used Memory</th>
      </tr>
    </thead>
    <tbody>
      #{EcoList}#
      <tr>
        <td class="breakAll"><code>#[tableIndexPath]#</code></td>
        <td>#[tableSize]#</td>
        <td>#[tableKeyChunkSize]#</td>
        <td>#[tableKeyMem]#</td>
        <td>#[tableValueChunkSize]#</td>
        <td>#[tableValueMem]#</td>
      </tr>
      #{/EcoList}#
    </tbody>
    <tfoot>
      <tr>
        <td colspan="6">Total Mem = #[EcoIndexTotalMem]# MB</td>
      </tr>
    </tfoot>
  </table>

  <h2>Object Index Caches</h2>
  <table>
    <thead>
      <tr>
        <th rowspan="2">Table</th>
        <th rowspan="2">Size</th>
        <th rowspan="2">Chunk Size</th>
        <th colspan="2">Memory</th>
      </tr>
      <tr>
        <th>Needed</th>
        <th>Used</th>
        <!-- <td>Flushes</td> -->
      </tr>
    </thead>
    <tbody>
      #{indexcache}#
      <tr>
        <td class="breakAll"><code>#[Name]#</code></td>
        <td>#[Count]#</td>
        <td>#[ChunkSize]#</td>
        <td>#[NeededMem]#</td>
        <td>#[UsedMem]#</td>
      </tr>
      #{/indexcache}#
    </tbody>
    <tfoot>
      <tr>
        <td colspan="5">Total Mem: #[indexcacheTotalMem]# MB</td>
      </tr>
    </tfoot>
  </table>

  <h2>Object Read Caches</h2>
  <table>
    <thead>
      <tr>
        <th rowspan="2">Table</th>
        <th colspan="9">Read Hit Cache</th>
        <th colspan="8">Read Miss Cache</th>
      </tr>
      <tr>
        <th>Size</th>
        <th>Chunk Size</th>
        <th>Used Memory</th>
        <th>Read Hit</th>
        <th>Read Miss</th>
        <th>Write Unique</th>
        <th>Write Double</th>
        <th>Deletes</th>
        <th>Flushes</th>
        <th>Size</th>
        <th>Chunk Size</th>
        <th>Used Memory</th>
        <th>Read Hit</th>
        <th>Read Miss</th>
        <th>Write Unique</th>
        <th>Write Double</th>
        <th>Deletes</th>
      </tr>
    </thead>
    <tbody>
      #{ObjectList}#
      <tr>
        <td>#[objectCachePath]#</td>
        <td>#[objectHitCacheCount]#</td>
        <td>#[objectHitChunkSize]#</td>
        <td>#[objectHitCacheMem]#</td>
        <td>#[objectHitCacheReadHit]#</td>
        <td>#[objectHitCacheReadMiss]#</td>
        <td>#[objectHitCacheWriteUnique]#</td>
        <td>#[objectHitCacheWriteDouble]#</td>
        <td>#[objectHitCacheDeletes]#</td>
        <td>#[objectHitCacheFlushes]#</td>
        <td>#[objectMissCacheCount]#</td>
        <td>#[objectMissChunkSize]#</td>
        <td>#[objectMissCacheMem]#</td>
        <td>#[objectMissCacheReadHit]#</td>
        <td>#[objectMissCacheReadMiss]#</td>
        <td>#[objectMissCacheWriteUnique]#</td>
        <td>#[objectMissCacheWriteDouble]#</td>
        <td>#[objectMissCacheDeletes]#</td>
      </tr>
    </tbody>
    #{/ObjectList}#
    <tfoot>
      <tr>
        <td colspan="18">Total Mem: #[objectHitCacheTotalMem]# MB (hit), #[objectMissCacheTotalMem]# MB (miss); Stop Grow when less than #[objectCacheStopGrow]# MB available left; Start Shrink when less than #[objectCacheStartShrink]# MB availabe left</td>
      </tr>
    </tfoot>
  </table>

  <h2>Other Caching Structures</h2>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Size</th>
        <th>Hit</th>
        <th>Miss</th>
        <th>Insert</th>
        <th>Delete</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>DNSCache/Hit</td>
        <td>#[namecacheHit.size]#</td>
        <td>#[namecacheHit.Hit]#</td>
        <td>#[namecacheHit.Miss]#</td>
        <td>#[namecacheHit.Insert]#</td>
        <td>(ARC)</td>
      </tr>
      <tr>
        <td>DNSCache/Miss</td>
        <td>#[namecacheMiss.size]#</td>
        <td>#[namecacheMiss.Hit]#</td>
        <td>#[namecacheMiss.Miss]#</td>
        <td>#[namecacheMiss.Insert]#</td>
        <td>(ARC)</td>
      </tr>
      <tr>
        <td>DNSNoCache</td>
        <td>#[namecache.noCache]#</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td>HashBlacklistedCache</td>
        <td>#[blacklistcache.size]#</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td>Search Event Cache</td>
        <td>#[searchevent.size]#</td>
        <td>#[searchevent.hit]#</td>
        <td>#[searchevent.miss]#</td>
        <td>#[searchevent.insert]#</td>
        <td>#[searchevent.delete]#</td>
      </tr>
    </tbody>
  </table>

  #%env/templates/page-end.template%#
</body>
</html>
