<!DOCTYPE html>
<html lang="en">
<head>
  <title>YaCy '#[clientname]#': Performance Settings for Memory</title>
  #%env/templates/header-backend.template%#
  <script type="text/javascript">
  <!--
  function reloadGraph() {
    if(document.forms["optionreloadGraph"].option.checked) {
      document.images["graph"].src="PerformanceGraph.png?nopeers=&amp;time="+(new Date()).getTime();
    }
    window.status="";
  }
  window.setInterval("reloadGraph()", 1000);
  //-->
  </script>
</head>

<body id="performanceMemory">
  #%env/templates/page-start.template%#

  <div id="devInfo">
    update scripts
  </div>

  <h1>Performance Settings for Memory</h1>

  <fieldset class="framed" style="width:600px;">
    <legend class="light">Performance Graph</legend>
    <img src="PerformanceGraph.png?nopeers=" id="graph" alt="Performance Graph"/>
  </fieldset>

  <form id="optionreloadGraph" action="" method="get">
    <p>
      <input type="checkbox" name="option" id="autoreload"/>
      <label for="autoreload">Auto refresh graph</label>
    </p>
  </form>

  <form action="PerformanceMemory_p.html" method="post" enctype="multipart/form-data" accept-charset="UTF-8">
    <fieldset>
      <legend>Options</legend>
      <fieldset class="formSection">
        <legend>Short Memory</legend>
        <div class="content">
          <input type="checkbox" name="simulatedshortmemory" id="simulatedshortmemory" #(simulatedshortmemory.checked)#:: checked="checked"#(/simulatedshortmemory.checked)#/>
          <label for="simulatedshortmemory">Simulate short memory status</label>
        </div>
      </fieldset>
      <fieldset class="formSection">
        <legend>Strategy</legend>
        <div class="content">
          <p>
            <input type="checkbox" name="useStandardmemoryStrategy" #(useStandardmemoryStrategy.checked)#:: checked="checked"#(/useStandardmemoryStrategy.checked)#/>
            <label for="">Use Standard Memory Strategy.</label>
          </p>
          <p>
            <s class="sym sym-hint"></s>
            Current: <em>#[memoryStrategy]#</em>
          </p>
        </div>
      </fieldset>
      <fieldset class="formControl">
        <div class="content">
          <button type="submit" class="primary icon-run">Update</button>
        </div>
      </fieldset>
    </fieldset>
    <p></p>
    <p></p>
  </form>

  <h2>Memory Usage</h2>
  <table class="multiBody">
    <thead>
      <tr>
        <th>Type</th>
        <th>After Startup</th>
        <th>After Initializations before <abbr>GC</abbr></th>
        <th>After Initializations after <abbr>GC</abbr></th>
        <th>Now #(gc)#before <a href="PerformanceMemory_p.html?gc=">GC</a>::after <abbr>GC</abbr>#(/gc)#</th>
      </tr>
    </thead>
    <tbody>
      <tr class="TableCellLight">
        <td class="TableCellDark" align="left">Max</td>
        <td align="center" colspan="4">#[memoryMax]# MByte</td>
      </tr>
      <tr>
        <td></td>
        <td colspan="4"><em>Description:</em> Maximum memory that the JVM will attempt to use.</td>
      </tr>
    </tbody>
    <tbody>
      <tr class="TableCellLight">
        <td class="TableCellDark" align="left">Available</td>
        <td align="right">#[memoryAvailAfterStartup]# MByte</td>
        <td align="right">#[memoryAvailAfterInitBGC]# MByte</td>
        <td align="right">#[memoryAvailAfterInitAGC]# MByte</td>
        <td align="right">#[memoryAvailNow]# MByte</td>
      </tr>
      <tr>
        <td></td>
        <td colspan="4"><em>Description:</em> Total available memory including free for the JVM within maximum.</td>
      </tr>
    </tbody>
    <tbody>
      <tr class="TableCellLight">
        <td class="TableCellDark" align="left">Total</td>
        <td align="right">#[memoryTotalAfterStartup]# KByte</td>
        <td align="right">#[memoryTotalAfterInitBGC]# KByte</td>
        <td align="right">#[memoryTotalAfterInitAGC]# KByte</td>
        <td align="right">#[memoryTotalNow]# MByte</td>
      </tr>
      <tr>
        <td></td>
        <td colspan="4"><em>Description:</em> Total memory taken from the <abbr>OS</abbr>.</td>
      </tr>
    </tbody>
    <tbody>
      <tr class="TableCellLight">
        <td class="TableCellDark" align="left">Free</td>
        <td align="right">#[memoryFreeAfterStartup]# KByte</td>
        <td align="right">#[memoryFreeAfterInitBGC]# KByte</td>
        <td align="right">#[memoryFreeAfterInitAGC]# KByte</td>
        <td align="right">#[memoryFreeNow]# MByte</td>
      </tr>
      <tr>
        <td></td>
        <td colspan="4"><em>Description:</em> Free memory in the JVM within total amount.</td>
      </tr>
    </tbody>
    <tbody>
      <tr class="TableCellLight">
        <td class="TableCellDark" align="left">Used</td>
        <td align="right">#[memoryUsedAfterStartup]# KByte</td>
        <td align="right">#[memoryUsedAfterInitBGC]# KByte</td>
        <td align="right">#[memoryUsedAfterInitAGC]# KByte</td>
        <td align="right">#[memoryUsedNow]# MByte</td>
      </tr>
      <tr>
        <td></td>
        <td colspan="4"><em>Description:</em> Used memory in the JVM within total amount.</td>
      </tr>
    </tbody>
  </table>

  <h2>Table RAM Index</h2>
  <table>
    <thead>
      <tr>
        <th rowspan="2">Table</th>
        <th rowspan="2">Size</th>
        <th colspan="2">Key</th>
        <th colspan="2">Value</th>
      </tr>
    </thead>
    <tbody>
      <tr class="th">
        <td>Chunk Size</td>
        <td>Used Memory</td>
        <td>Chunk Size</td>
        <td>Used Memory</td>
      </tr>
      #{EcoList}#
      <tr>
        <td class="breakAll"><code>#[tableIndexPath]#</code></td>
        <td align="right">#[tableSize]#</td>
        <td align="right">#[tableKeyChunkSize]#</td>
        <td align="right">#[tableKeyMem]#</td>
        <td align="right">#[tableValueChunkSize]#</td>
        <td align="right">#[tableValueMem]#</td>
      </tr>
      #{/EcoList}#
      <tfoot>
        <tr>
          <td colspan="9">Total Mem = #[EcoIndexTotalMem]# MB</td>
        </tr>
      </tfoot>
    </tbody>
  </table>

  <h2>Object Index Caches</h2>
  <table>
    <thead>
      <tr>
        <th>Table</th>
        <th>Size</th>
        <th>Chunk Size</th>
        <th>Needed Memory</th>
        <th>Used Memory</th>
        <!-- <td>Flushes</td> -->
      </tr>
    </thead>
    <tbody>
      #{indexcache}#
      <tr class="TableCellLight">
        <td class="breakAll"><code>#[Name]#</code></td>
        <td align="right">#[Count]#</td>
        <td align="right">#[ChunkSize]#</td>
        <td align="right">#[NeededMem]#</td>
        <td align="right">#[UsedMem]#</td>
      </tr>
      #{/indexcache}#
      <tfoot>
        <tr>
          <td colspan="9">Total Mem: #[indexcacheTotalMem]# MB</td>
        </tr>
      </tfoot>
    </tbody>
  </table>

  <h2>Object Read Caches</h2>
  <table>
    <thead>
      <tr>
        <th></th>
        <th colspan="9">Read Hit Cache</th>
        <th colspan="8">Read Miss Cache</th>
      </tr>
    </thead>
    <tbody>
      <tr class="th">
        <td>Table</td>
        <td>Size</td>
        <td>Chunk Size</td>
        <td>Used Memory</td>
        <td>Read Hit</td>
        <td>Read Miss</td>
        <td>Write Unique</td>
        <td>Write Double</td>
        <td>Deletes</td>
        <td>Flushes</td>
        <td>Size</td>
        <td>Chunk Size</td>
        <td>Used Memory</td>
        <td>Read Hit</td>
        <td>Read Miss</td>
        <td>Write Unique</td>
        <td>Write Double</td>
        <td>Deletes</td>
        <!-- <td>Flushes</td> -->
      </tr>
      #{ObjectList}#
      <tr class="TableCellLight">
        <td align="left" class="TableCellDark">#[objectCachePath]#</td>
        <td align="right">#[objectHitCacheCount]#</td>
        <td align="right">#[objectHitChunkSize]#</td>
        <td align="right">#[objectHitCacheMem]#</td>
        <td align="right">#[objectHitCacheReadHit]#</td>
        <td align="right">#[objectHitCacheReadMiss]#</td>
        <td align="right">#[objectHitCacheWriteUnique]#</td>
        <td align="right">#[objectHitCacheWriteDouble]#</td>
        <td align="right">#[objectHitCacheDeletes]#</td>
        <td align="right">#[objectHitCacheFlushes]#</td>
        <td align="right">#[objectMissCacheCount]#</td>
        <td align="right">#[objectMissChunkSize]#</td>
        <td align="right">#[objectMissCacheMem]#</td>
        <td align="right">#[objectMissCacheReadHit]#</td>
        <td align="right">#[objectMissCacheReadMiss]#</td>
        <td align="right">#[objectMissCacheWriteUnique]#</td>
        <td align="right">#[objectMissCacheWriteDouble]#</td>
        <td align="right">#[objectMissCacheDeletes]#</td>
        <!-- <td align="right">#[objectMissCacheFlushes]#</td> -->
      </tr>
      #{/ObjectList}#
      <tfoot>
        <tr class="TableCellDark">
          <td colspan="19">Total Mem: #[objectHitCacheTotalMem]# MB (hit), #[objectMissCacheTotalMem]# MB (miss); Stop Grow when less than #[objectCacheStopGrow]# MB available left; Start Shrink when less than #[objectCacheStartShrink]# MB availabe left</td>
        </tr>
      </tfoot>
    </tbody>
  </table>

  <h2>Other Caching Structures</h2>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Size</th>
        <th>Hit</th>
        <th>Miss</th>
        <th>Insert</th>
        <th>Delete</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>DNSCache/Hit</td>
        <td>#[namecacheHit.size]#</td>
        <td>#[namecacheHit.Hit]#</td>
        <td>#[namecacheHit.Miss]#</td>
        <td>#[namecacheHit.Insert]#</td>
        <td>(ARC)</td>
      </tr>
      <tr>
        <td>DNSCache/Miss</td>
        <td>#[namecacheMiss.size]#</td>
        <td>#[namecacheMiss.Hit]#</td>
        <td>#[namecacheMiss.Miss]#</td>
        <td>#[namecacheMiss.Insert]#</td>
        <td>(ARC)</td>
      </tr>
      <tr>
        <td>DNSNoCache</td>
        <td>#[namecache.noCache]#</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td>HashBlacklistedCache</td>
        <td>#[blacklistcache.size]#</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td>Search Event Cache</td>
        <td>#[searchevent.size]#</td>
        <td>#[searchevent.hit]#</td>
        <td>#[searchevent.miss]#</td>
        <td>#[searchevent.insert]#</td>
        <td>#[searchevent.delete]#</td>
      </tr>
    </tbody>
  </table>

  #%env/templates/page-end.template%#
</body>
</html>
