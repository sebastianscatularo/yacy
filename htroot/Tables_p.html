<!DOCTYPE html>
<html lang="en">
<head>
  <title>YaCy '#[clientname]#': Table Viewer</title>
  #%env/templates/header-backend.template%#
  #(showtable)#::
  <link rel="alternate" type="application/xml" title="Tables" href="Tables.rss?table=#[table]#" />
  #(/showtable)#
  <script type="text/javascript" src="/js/yaml/tablesorter/jquery.tablesorter.min.js"></script>
  <script type="text/javascript" src="/js/yaml/pages/tables.js"></script>
</head>

<body id="tables">
  #%env/templates/page-start.template%#

  <div id="devInfo" data-done="html5 interaction handler" data-skip="validators">
  </div>

  <div id="api">
    <a class="api" href="#">
      <img class="api" src="env/grafics/api.png" alt="API">
    </a>
  </div>

  #(showselection)#::
  <h1>Table Administration</h1>
  <form id="tableAdmin" action="Tables_p.html#tableAdmin" method="get" accept-charset="UTF-8">
    <fieldset>
      <legend>Table Selection</legend>

      <fieldset class="formSection">
        <legend>Table</legend>
        <div class="content">
          <select name="table" id="tableAdminSelect">
            #{tables}#
            <option value="#[name]#" #(selected)#::selected="selected"#(/selected)#>#[name]#</option>
            #{/tables}#
          </select>
        </div>
      </fieldset>
      <fieldset class="formSection">
        <legend>Limit</legend>
        <div class="content">
          <label for="tableAdminCount">Show a maximum of</label>
          <select name="count" id="tableAdminCount">
            <option value="10">10</option>
            <option value="100" selected="selected">100</option>
            <option value="1000">1000</option>
            <option value="all">all</option>
          </select>
          entries.
        </div>
      </fieldset>
      <fieldset class="formSection">
        <legend>Search string</legend>
        <div class="content">
          <input type="text" name="search" value="#[pattern]#"/>
        </div>
      </fieldset>
      <fieldset class="formControl">
        <div class="content">
          <button type="submit" name="edittable" class="primary icon-run">Search</button>
        </div>
      </fieldset>
    </fieldset>
  </form>
  #(/showselection)#

  #(showtable)#::
  <form action="Tables_p.html#tableEditor" method="post" enctype="multipart/form-data" accept-charset="UTF-8" id="tablelisting">
    <fieldset>
      <legend>Table Editor: <em>#[table]#</em></legend>
      <input type="hidden" name="table" value="#[table]#" />
      <input type="hidden" name="num" value="#[num]#" />
      <div class="content noIndent">
        <table class="sortable" id="editTable">
          <thead>
            <tr>
              <th>
                <input type="checkbox" data-action="checkAllToggle"/>
              </th>
              <th>PK</th>
              #{columns}#
              <th>#[header]#</th>
              #{/columns}#
            </tr>
          </thead>
          <tbody>
            #{list}#
            <tr>
              <td><input type="checkbox" name="item_#[count]#" value="pk_#[pk]#" /></td>
              <td>#[pk]#</td>
              #{columns}#
              <td class="breakAll">#[cell]#</td>
              #{/columns}#
            </tr>
            #{/list}#
          </tbody>
        </table>
      </div>
      <fieldset class="formControl">
        <div class="content">
          <button type="submit" name="deletetable" class="icon-delete">Clear Table</button>
          <button type="submit" name="deleterows" id="submitDeleteRows" class="icon-delete">Delete Selected Rows</button>
          <button type="submit" name="editrow" id="submitEditRows" class="icon-edit">Edit Selected Row</button>
          <button type="submit" name="addrow" class="icon-add primary">Add a new Row</button>
        </div>
      </fieldset>
    </fieldset>
  </form>
  #(/showtable)#

  #(showedit)#::
  <form id="tableEditor" action="Tables_p.html" method="post" enctype="multipart/form-data" accept-charset="UTF-8">
    <fieldset>
      <legend>Row Editor</legend>
      <input type="hidden" name="table" value="#[table]#" />
      <input type="hidden" name="pk" value="#[pk]#" />
      <fieldset class="formSection">
        <legend>Primary Key</legend>
        <div class="content">
          #[pk]#
        </div>
      </fieldset>
      #{list}#
      <fieldset class="formSection">
        <legend>#[key]#</legend>
        <div class="content">
          <input type="text" name="col_#[key]#" value="#[value]#"/>
        </div>
      </fieldset>
      #{/list}#

      <fieldset class="formControl">
        <div class="content">
          <button type="submit" name="commitrow" class="primary icon-run">Save</button>
        </div>
      </fieldset>
    </fieldset>
  </form>
  #(/showedit)#
  #%env/templates/page-end.template%#
</body>
</html>
