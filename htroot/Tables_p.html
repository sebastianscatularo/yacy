<!DOCTYPE html>
<html lang="en">
<head>
  <title>YaCy '#[clientname]#': Table Viewer</title>
  #%env/templates/header-backend.template%#
  #(showtable)#::
  <link rel="alternate" type="application/xml" title="Tables" href="Tables.rss?table=#[table]#" />
  #(/showtable)#
  <script type="text/javascript" src="/js/yaml/tablesorter/jquery.tablesorter.min.js"></script>
  <script type="text/javascript">
  <!--
  function setall(name, check){
    var selectForm = document.forms.namedItem(name);
    var count = selectForm.elements["num"].value;
    if (check) for(i = 0; i < count; i++) {
     if (selectForm.elements["item_" + i].checked) {
       check = false;
       break;
     }
   }
   for(i = 0; i < count; i++) {
    selectForm.elements["item_" + i].checked = check;
  }
}
-->
</script>
</head>

<body id="tables">
  #%env/templates/page-start.template%#

  <script type="text/javascript">
    //<![CDATA[
    if (window.location.search.length > 1) {
      document.write("<div id=\"api\">\<a href=\"/api/table_p.xml" + window.location.search + "\"\><img src=\"env/grafics/api.png\" width=\"60\" height=\"40\" alt=\"API\"/></a></div>");
    }
    //]]>
    </script>

    #(showselection)#::
    <h1>Table Administration</h1>
    <form id="tableAdmin" action="Tables_p.html#tableAdmin" method="get" accept-charset="UTF-8">
      <fieldset>
        <legend>Table Selection</legend>

        <fieldset class="formSection">
          <legend>Table</legend>
          <div class="content">
            <select name="table" onchange='this.form.submit()'>
              #{tables}#
              <option value="#[name]#" #(selected)#::selected="selected"#(/selected)#>#[name]#</option>
              #{/tables}#
            </select>
          </div>
        </fieldset>
        <fieldset class="formSection">
          <legend>Limit</legend>
          <div class="content">
            <label for="showSize">Show a maximum of</label>
            <select name="count" onchange='this.form.submit()' id="showSize">
              <option value="10">10</option>
              <option value="100" selected="selected">100</option>
              <option value="1000">1000</option>
              <option value="all">all</option>
            </select>
            entries.
          </div>
        </fieldset>
        <fieldset class="formSection">
          <legend>Search string</legend>
          <div class="content">
            <input type="text" name="search" value="#[pattern]#"/>
          </div>
        </fieldset>
        <fieldset class="formControl">
          <div class="content">
            <button type="submit" name="edittable" class="primary icon-run">Search</button>
          </div>
        </fieldset>
      </fieldset>
    </form>
    #(/showselection)#

    #(showtable)#::
    <form action="Tables_p.html#tableEditor" method="post" enctype="multipart/form-data" accept-charset="UTF-8" id="tablelisting">
      <fieldset>
        <legend>Table Editor: <em>#[table]#</em></legend>
        <input type="hidden" name="table" value="#[table]#" />
        <input type="hidden" name="num" value="#[num]#" />
        <div class="content noIndent">
          <table class="sortable">
            <thead>
              <tr>
                <th>
                  <input type="checkbox" data-action="checkAllToggle"/>
                </th>
                <th>PK</th>
                #{columns}#
                <th>#[header]#</th>
                #{/columns}#
              </tr>
            </thead>
            <tbody>
              #{list}#
              <tr class="TableCell#(dark)#Light::Dark::Summary#(/dark)#">
                <td align="left"><input type="checkbox" name="item_#[count]#" value="pk_#[pk]#" /></td>
                <td>#[pk]#</td>
                #{columns}#
                <td align="left">#[cell]#</td>
                #{/columns}#
              </tr>
              #{/list}#
            </tbody>
          </table>
        </div>
        <fieldset class="formControl">
          <div class="content">
            <button type="submit" name="deletetable" class="icon-delete">Delete Table</button>
            <button type="submit" name="deleterows" class="icon-delete">Delete Selected Rows</button>
            <button type="submit" name="editrow" class="icon-edit">Edit Selected Row</button>
            <button type="submit" name="addrow" class="icon-add primary">Add a new Row</button>
          </div>
        </fieldset>
      </fieldset>
    </form>
    #(/showtable)#

    #(showedit)#::
    <form id="tableEditor" action="Tables_p.html" method="post" enctype="multipart/form-data" accept-charset="UTF-8">
      <fieldset>
        <legend>Row Editor</legend>
        <input type="hidden" name="table" value="#[table]#" />
        <input type="hidden" name="pk" value="#[pk]#" />
        <fieldset class="formSection">
          <legend>Primary Key</legend>
          <div class="content">
            #[pk]#
          </div>
        </fieldset>
        #{list}#
        <fieldset class="formSection">
          <legend>#[key]#</legend>
          <div class="content">
            <input type="text" name="col_#[key]#" value="#[value]#" size="80"/>
          </div>
        </fieldset>
        #{/list}#

        <fieldset class="formControl">
          <div class="content">
            <button type="submit" name="commitrow" class="primary icon-run">Save</button>
          </div>
        </fieldset>
      </fieldset>
    </form>
    #(/showedit)#
    #%env/templates/page-end.template%#
  </body>
  </html>
