<!DOCTYPE html>
<html lang="en">
<head>
  <title>YaCy '#[clientname]#': Access Tracker</title>
  #%env/templates/header-backend.template%#
  <script type="text/javascript" src="/js/yaml/tablesorter/jquery.tablesorter.min.js"></script>
</head>

<body id="accessTracker">
  #%env/templates/page-start.template%#

  #(page)#
  <h1>Server Access Overview</h1>
  <p>
    This is a list of #[num]# requests to the local http server within the last hour.
  </p>
  <table>
    <thead>
      <tr>
        <th rowspan="2">Host</th>
        <th colspan="4">Access Count During</th>
      </tr>
    </thead>
    <tbody>
      <tr class="th">
        <td></td>
        <td>last Second</td>
        <td>last Minute</td>
        <td>last 10 Minutes</td>
        <td>last Hour</td>
      </tr>
      #{list}#
      <tr class="TableCell#(dark)#Light::Dark#(/dark)#">
        <td><a href="AccessTracker_p.html?page=1&amp;host=#[host]#">#[host]#</a></td>
        <td>#[countSecond]#</td>
        <td>#[countMinute]#</td>
        <td>#[count10Minutes]#</td>
        <td>#[countHour]#</td>
      </tr>
      #{/list}#
    </tbody>
  </table>

  <h2>Malicious Hosts</h2>
  <p>
    The following hosts are registered as source for brute-force requests to protected pages.
  </p>
  <table class="sortable">
    <thead>
      <tr>
        <th>Host</th>
        <th>Access Times</th>
      </tr>
    </thead>
    <tbody>
      #{bflist}#
      <tr class="TableCell#(dark)#Light::Dark#(/dark)#">
        <td>#[host]#</td>
        <td>#[countSecond]#</td>
      </tr>
      #{/bflist}#
    </tbody>
  </table>
  ::
  <h1>Server Access Details</h1>
  <p>
    This is a list of requests to the local http server within the last hour.
    <br/>
    Showing #[num]# requests.
  </p>
  <table class="sortable">
    <thead>
      <tr>
        <th>Host</th>
        <th>Date</th>
        <th>Path</th>
      </tr>
    </thead>
    <tbody>
      #{list}#
      <tr class="TableCell#(dark)#Light::Dark#(/dark)#">
        <td><a href="AccessTracker_p.html?page=1&amp;host=#[host]#">#[host]#</a></td>
        <td>#[date]#</td>
        <td class="breakAll"><a href="#[path]#">#[path]#</a></td>
      </tr>
      #{/list}#
    </tbody>
  </table>
  ::
  <h1>Local Search Log</h1>
  <p>
    This is a list of searches that had been requested from this' peer search interface.
    <br/>
    Showing #[num]# entries from a total of #[total]# requests.
  </p>
  <table class="sortable">
    <thead>
      <tr>
        <th>Requesting Host</th>
        <th>Date</th>
        <th>Offset</th>
        <th>Expected Results</th>
        <th>Returned Results</th>
        <th>Known Results</th>
        <th>Used Time (ms)</th>
        <th>URL fetch (ms)</th>
        <th>Snippet comp (ms)</th>
        <th>Query</th>
        <th>User Agent</th>
      </tr>
    </thead>
    <tfoot>
      <tr class="th">
        <td></td>
        <td></td>
        <td></td>
        <td>&#216; #[querycount_avg]#</td>
        <td>&#216; #[transmitcount_avg]#</td>
        <td>&#216; #[resultcount_avg]#</td>
        <td>&#216; #[resulttime_avg]#</td>
        <td>&#216; #[urltime_avg]#</td>
        <td>&#216; #[snippettime_avg]#</td>
        <td></td>
        <td></td>
      </tr>
    </tfoot>
    <tbody>
      #{list}#
      <tr>
        <td>#[host]#</td>
        <td>#[date]#</td>
        <td>#[offset]#</td>
        <td>#[querycount]#</td>
        <td>#[transmitcount]#</td>
        <td>#[resultcount]#</td>
        <td>#[resulttime]#</td>
        <td>#[urltime]#</td>
        <td>#[snippettime]#</td>
        <td class="breakAll"><a href="/yacysearch.html?query=#[querystring]#&amp;resource=local">#[querystring]#</a></td>
        <td class="breakAll">#[userAgent]#</td>
      </tr>
      #{/list}#
    </tbody>
  </table>
  ::
  <h1>Local Search Host Tracker</h1>
  <p>
    This is a list of searches that had been requested from this' peer search interface.
    <br/>
    Showing #[num]# entries from a total of #[total]# requests.
  </p>
  <table class="sortable">
    <thead>
      <tr>
        <th>Requesting Host</th>
        <th>Count</th>
        <th>Queries Per Last Hour</th>
        <th>Access Dates</th>
      </tr>
    </thead>
    <tfoot>
      <tr class="th">
        <td></td>
        <td>&#931; #[total]#</td>
        <td>&#931; #[qph_sum]#</td>
        <td></td>
      </tr>
    </tfoot>
    <tbody>
      #{list}#
      <tr>
        <td>#[host]#</td>
        <td>#[count]#</td>
        <td>#[qph]#</td>
        <td>#{dates}##[date]# #{/dates}#</td>
      </tr>
      #{/list}#
    </tbody>
  </table>
  ::
  <h1>Remote Search Log</h1>
  <p>
    This is a list of searches that had been requested from remote peer search interface.
    <br/>
    Showing #[num]# entries from a total of #[total]# requests.
  </p>
  <table class="sortable">
    <thead>
      <tr>
        <th>Requesting Host</th>
        <th>Peer Name</th>
        <th>Date</th>
        <th>Expected Results</th>
        <th>Returned Results</th>
        <th>Used Time (ms)</th>
        <th>URL fetch (ms)</th>
        <th>Snippet comp (ms)</th>
        <th>Search Word Hashes</th>
      </tr>
    </thead>
    <tfoot>
      <tr class="th">
        <td>Total: #[num]#
          <br/>Success: #[resultcount]#
        </td>
        <td></td>
        <td></td>
        <td>&#216; #[querycount_avg]#</td>
        <td>
          <!--&#216; #[resultcount_avg]#-->
          <br/>&#216; #[transmitcount_avg]#
        </td>
        <td>
          &#216; #[resulttime_avg]#
          <br/>&#216; #[resulttime_avg1]#
        </td>
        <td>
          &#216; #[urltime_avg]#
          <br/>&#216; #[urltime_avg1]#
        </td>
        <td>
          &#216; #[snippettime_avg]#
          <br/>&#216; #[snippettime_avg1]#
        </td>
        <td></td>
      </tr>
    </tfoot>
    <tbody>
      #{list}#
      <tr>
        <td>#[host]#</td>
        <td>#[peername]#</td>
        <td>#[date]#</td>
        <td>#[querycount]#</td>
        <td>#[transmitcount]#</td>
        <td>#[resulttime]#</td>
        <td>#[urltime]#</td>
        <td>#[snippettime]#</td>
        <td>#[queryhashes]#</td>
      </tr>
      #{/list}#
    </tbody>
  </table>
  ::
  <h1>Remote Search Host Tracker</h1>
  <p>
    This is a list of searches that had been requested from remote peer search interface.
    <br/>
    Showing #[num]# entries from a total of #[total]# requests.
  </p>
  <table class="sortable">
    <thead>
      <tr>
        <th>Requesting Host</th>
        <th>Peer Name</th>
        <th>Count</th>
        <th>Queries Per Last Hour</th>
        <th>Access Dates</th>
      </tr>
    </thead>
    <tfoot>
      <tr class="th">
        <td></td>
        <td></td>
        <td>&#931; #[total]#</td>
        <td>&#931; #[qph_sum]#</td>
        <td></td>
      </tr>
    </tfoot>
    <tbody>
      #{list}#
      <tr>
        <td>#[host]#</td>
        <td>#[peername]#</td>
        <td>#[count]#</td>
        <td>#[qph]#</td>
        <td>#{dates}##[date]# #{/dates}#</td>
      </tr>
      #{/list}#
    </tbody>
  </table>
  #(/page)#
  #%env/templates/page-end.template%#
</body>
</html>
