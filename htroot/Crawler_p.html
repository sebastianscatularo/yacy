<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>YaCy '#[clientname]#': Crawler</title>
  #%env/templates/header-backend.template%#
  <script type="text/javascript" src="/js/ajax.js"></script>
  <script type="text/javascript" src="/js/xml.js"></script>
  <script type="text/javascript" src="/js/html.js"></script>
  <script type="text/javascript" src="/js/rss2.js"></script>
  <script type="text/javascript" src="/js/Crawler.js"></script>
</head>

<body id="crawler" onload="initCrawler();">
  <ul class="ym-skiplinks">
    <li><a class="ym-skip" href="#nav">Skip to navigation (Press Enter)</a></li>
    <li><a class="ym-skip" href="#main">Skip to main content (Press Enter)</a></li>
  </ul>

  #%env/templates/header.template%#

  <main>
    <div class="ym-wrapper">
      <div class="ym-wbox">
        <div id="api">
          <a href="/api/status_p.xml" title="Click on this API button to see an XML with information about the crawler status."><img src="/env/grafics/api.png" width="60" height="40" alt="API"/></a>
        </div>

<div id="devInfo">
Todo:
 - scripts fail (need updates)
 - style
 - linkstructure script needs updates
</div>

        <div id="formResults">
            #(info)#
            <!-- 0 -->
            ::
            <!-- 1 -->
            <p class="error">
              Error with profile management. Please stop YaCy, delete the file <code>DATA/PLASMADB/crawlProfiles0.db</code> and restart.
            </p>
            ::
            <!-- 2 -->
            <p class="error">
              Error: #[errmsg]#
            </p>
            ::
            <!-- 3 -->
            Application not yet initialized. Sorry. Please wait some seconds and repeat
            the request.
            ::
            <!-- 4 -->
            <p class="error">
              <strong>Crawl filter "#[newcrawlingfilter]#" does not match with
              crawl root "#[crawlingStart]#".</strong>
              Please try again with different
              filter.
            </p>
            ::
            <!-- 5 -->
            <p class="error">
              Crawling of "#[crawlingURL]#" failed. Reason: #[reasonString]#
            </p>
            ::
            <!-- 6 -->
            <p class="error">
              Error with URL input "#[crawlingStart]#": #[error]#
            </p>
            ::
            <!-- 7 -->
            <p class="error">
              Error with file input "#[crawlingStart]#": #[error]#
            </p>
            ::
            <!-- 8 -->
            <p class="success">
              Crawling of <code>#[crawlingURL]#</code> started.
              <br/>
              <strong>Please wait some seconds, it may take some seconds until the first result appears there.</strong>
              If you crawl any un-wanted pages, you can delete them <a href="IndexCreateQueues_p.html?stack=LOCAL">here</a>.
            </p>
            #(/info)#
        </div>

        <h1>Crawler</h1>

        <h2>Queues</h2>
        <table>
          <thead>
            <tr>
              <th>Queue</th>
              <th>Size</th>
              <th>Pause/Resume</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Local Crawler</td>
              <td align="right"><span id="localcrawlerqueuesize">#[localCrawlSize]#</span></td>
              <td>
                <a href="" id="localcrawlerstateA">
                  <img src="" alt="" style="width:12px; height:12px;" id="localcrawlerstateIMG" />
                </a>
              </td>
            </tr>
            <tr>
              <td align="left">Limit Crawler</td>
              <td align="right"><span id="limitcrawlerqueuesize">#[limitCrawlSize]#</span></td>
              <td>
                <a href="" title="" id="limitcrawlerstateA">
                  <img src="" alt="" style="width:12px; height:12px;" id="limitcrawlerstateIMG" />
                </a>
              </td>
            </tr>
            <tr>
              <td align="left">Remote Crawler</td>
              <td align="right"><span id="remotecrawlerqueuesize">#[remoteCrawlSize]#</span></td>
              <td>
                <a href="" title="" id="remotecrawlerstateA">
                  <img src="" alt="" style="width:12px; height:12px;" id="remotecrawlerstateIMG" />
                </a>
              </td>
            </tr>
            <tr>
              <td align="left">No-Load Crawler</td>
              <td align="right"><span id="noloadcrawlerqueuesize">#[noloadCrawlSize]#</span></td>
              <td>
                <a href="" title="" id="noloadcrawlerstateA">
                  <img src="" alt="" style="width:12px; height:12px;" id="noloadcrawlerstateIMG" />
                </a>
              </td>
            </tr>
            <tr>
              <td align="left">Loader (<span id="loaderqueuemax">#[loaderMax]#</span>)</td>
              <td align="right"><span id="loaderqueuesize">#[loaderSize]#</span></td>
              <td>&nbsp;</td>
            </tr>
          </tbody>
        </table>
        <div class="warning" id="message">&nbsp;#[queuemessage]#</div>

        <h2>Index Size</h2>
        <table>
          <thead>
            <tr class="TableHeader">
              <th>Database</th>
              <th>Entries</th>
              <th>Segments</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Documents<br/><a href="#[urlpublictextSolrURL]#">solr search api</a></td>
              <td align="right"><span id="urlpublictextSize">#[urlpublictextSize]#</span></td>
              <td align="right"><span id="urlpublictextSegmentCount">#[urlpublictextSegmentCount]#</span></td>
            </tr>
            <tr>
              <td align="left">Webgraph Edges<br/><a href="#[webgraphSolrURL]#">solr search api</a></td>
              <td align="right"><span id="webgraphSize">#[webgraphSize]#</span></td>
              <td align="right"><span id="webgraphSegmentCount">#[webgraphSegmentCount]#</span></td>
            </tr>
            <tr>
              <td align="left">Citations<br/>(reverse link index)</td>
              <td align="right"><span id="citationSize">#[citationSize]#</span></td>
              <td align="right"><span id="citationSegmentCount">#[citationSegmentCount]#</span></td>
            </tr>
            <tr>
              <td align="left">RWIs<br/>(P2P Chunks)</td>
              <td align="right"><span id="rwipublictextSize">#[rwipublictextSize]#</span></td>
              <td align="right"><span id="rwipublictextSegmentCount">#[rwipublictextSegmentCount]#</span></td>
            </tr>
          </tbody>
        </table>

        <h2>Progress</h2>
        <form action="Crawler_p.html" method="post" enctype="multipart/form-data" accept-charset="UTF-8">
          <table>
            <thead>
              <tr>
                <th>Indicator</th>
                <th colspan="4">Level</th>
              </tr>
            </thead>
            <tbody>
              <tr class="TableCellLight">
                <td align="left">Speed / <abbr title="Pages Per Minute">PPM</abbr></td>
                <td align="left" colspan="4">
                  <button #(crawlingSpeedMinChecked)#::class="TableCellDark"#(/crawlingSpeedMinChecked)# type="submit" name="crawlingPerformance">Minimum</button>
                  <input #(crawlingSpeedCustChecked)#::class="TableCellDark"#(/crawlingSpeedCustChecked)# id="customPPM" name="customPPM" type="text" size="5" maxlength="5" value="#[customPPMdefault]#" /><abbr title="Pages Per Minute">PPM</abbr>
                  <button type="submit" name="crawlingPerformance">custom</button>
                  <button #(crawlingSpeedMaxChecked)#::class="TableCellDark"#(/crawlingSpeedMaxChecked)# type="submit" name="crawlingPerformance">maximum</button>
                </td>
              </tr>
              <tr>
                <td align="left">Crawler <abbr title="Pages Per Minute">PPM</abbr></td>
                <td align="left"><span id="ppmNum"></span></td>
                <td align="left" colspan="3">
                  <progress id="ppmbar" max="30000" value="0" style="width:94%;"/>
                </td>
              </tr>
              <tr>
                <td align="left" valign="top" rowspan="2">
                  Postprocessing Progress <span id="postprocessing_speed"></span>
                </td>
                <td align="left">
                  <span id="postprocessing_status"></span>
                </td>
                <td align="left" colspan="3">
                  <span id="postprocessing_bar">
                    <progress id="postprocessingBar" max="30000" value="0" style="width:94%;"/>
                  </span>
                </td>
              </tr>
              <tr>
                <td align="left">
                  <span id="postprocessing_remainingTimeMinutes">0</span>:<span id="postprocessing_remainingTimeSeconds">0</span>
                </td>
                <td align="left">
                  <span id="postprocessing_collection"></span>
                </td>
                <td align="left">
                  <span id="postprocessing_webgraph"></span>
                </td>
              </tr>
              <tr>
                <td align="left">Traffic (Crawler)</td>
                <td align="left"><span id="trafficCrawler"></span> MB</td>
                <td colspan="3"></td>
              </tr>
              <tr>
                <td align="left">Load</td>
                <td align="left"><span id="load"></span></td>
                <td colspan="3"></td>
              </tr>
            </tbody>
          </table>
        </form>

        <!-- crawl profile list -->
        #(crawlProfilesShow)#::
        <h2>Running Crawls (#[count]#)</h2>
        <table summary="A list of crawl profiles and their current settings.">
          <colgroup>
            <col width="16" />
            <col width="140"/>
          </colgroup>
          <thead>
            <tr>
              <th>Name</th>
              #(debug)#::<th>Count</th>#(/debug)#
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            #{list}#
            <tr>
              <td>#[name]#</td>
              #(debug)#::<td>#[count]#</td>#(/debug)#
              <td>
                #(terminateButton)#::
                <div style="text-decoration:blink;float:left;">Running</div>
                <form style="float:left;" action="Crawler_p.html" method="get" enctype="multipart/form-data" accept-charset="UTF-8"><div>
                  <input type="hidden" name="handle" value="#[handle]#" />
                  <input type="submit" name="terminate" value="Terminate" />
                </form>
              </div>
              #(/terminateButton)#
            </td>
          </tr>
          #{/list}#
        </table>
        #(linkstructure)#::
        <script type="text/javascript">
          <!--
          imagestub = "WebStructurePicture_p.png?host=#[hosts]#&depth=4&width=1024&height=512&nodes=600&time=1000&colortext=888888&colorback=FFFFFF&colordot0=1111BB&colordota=11BB11&colorline=222222&colorlineend=333333";
          idx = 0;
          setTimeout("doanimation(500)", 500);
          function doanimation(nexttimeout) {
            var accessPicture = document.getElementById("WebPicture");
            if (accessPicture != null) {
              idx++;
              accessPicture.src = imagestub + "&idx=" + idx;
              setTimeout("doanimation(" + (nexttimeout > 3000 ? 3000 : nexttimeout * 1.2) + ")", nexttimeout);
            }
          }
          -->
        </script>
        <div style="clear:both; text-align:left;">
          <img id="WebPicture" src="/env/grafics/invisible.png"/>
        </div>
        #(/linkstructure)#

        <h2>Crawled Pages</h2>
        <p id="crawllist"></p>
      </fieldset>
      #(/crawlProfilesShow)#
    </div>
  </div>
</main>
<footer class="hidden">
  #%env/templates/footer.template%#
</footer>
</body>
</html>
