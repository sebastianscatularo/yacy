<!DOCTYPE html>
<html lang="en">
<head>
  <title>YaCy '#[clientname]#': Federated Index</title>
  #%env/templates/header-backend.template%#
  <script type="text/javascript">
  var YaCyAPILink = 'Vocabulary_p.xml?' + window.location.search.substring(1);
  </script>
  <script type="text/javascript">
    //<![CDATA[
    function xmlhttpPost() {
      var searchform = document.getElementById('searchform');
      search(searchform.discoverobjectspace.value);
    }

    function search(query) {
      var xmlHttpReq = false;
      var self = this;
      if (window.XMLHttpRequest) { // Mozilla/Safari
        self.xmlHttpReq = new XMLHttpRequest();
      } else if (window.ActiveXObject) { // IE
        self.xmlHttpReq = new ActiveXObject("Microsoft.XMLHTTP");
      }
      self.xmlHttpReq.open('GET', "yacysearch.json?verify=false&resource=local&maximumRecords=100&nav=none&query=" + query + "+inurl:" + query, true);
      self.xmlHttpReq.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
      self.xmlHttpReq.onreadystatechange = function() {
        if (self.xmlHttpReq.readyState == 4) {
          updatepage(self.xmlHttpReq.responseText);
        }
      }
      self.xmlHttpReq.send(null);
    }

    function updatepage(str) {
      var raw = document.getElementById("raw");
      if (raw != null) raw.innerHTML = str;
      var rsp = eval("("+str+")");
      var firstChannel = rsp.channels[0];
      var totalResults = firstChannel.totalResults.replace(/[,.]/,"");
      var startIndex = firstChannel.startIndex;
      var itemsPerPage = firstChannel.itemsPerPage;
      var navigation = firstChannel.navigation;

      var html = "";

      if (totalResults > 0 && firstChannel.items.length > 0) {
        var item;
        html += "<table class=\"networkTable\" border=\"0\" cellpadding=\"2\" cellspacing=\"1\" width=\"99%\">";
        html += "<tr class=\"TableHeader\" valign=\"bottom\">";
        html += "<td>URL from index (total results = " + totalResults + ")<\/td>";
        for (var i = 0; i < firstChannel.items.length; i++) {
          item = firstChannel.items[i];
          html += "<tr class=\"TableCellLight\"><td align=\"left\" onclick=\"document.getElementById('searchform').value='" + item.link + "';\">" + item.link + "<\/td>";
        }
        html += "<\/table>";
      }
      document.getElementById("searchresults").innerHTML = html;
    }
  //]]>
  </script>
</head>

<body id="vocabulary">
  #%env/templates/page-start.template%#

  #(edit)#::
  <div id="api">
    <img class="api" src="/env/grafics/api.png" alt="API"/>
    <div>
      The information that is presented on this page can also be retrieved as <a href="#" id="apiLink">XML</a>. Click the XML-link to see the <abbr>RDF</abbr> Ontology definition for this vocabulary.
      To see a list of all <abbr>APIs</abbr>, please visit the <a href="http://www.yacy-websuche.de/wiki/index.php/Dev:API">API wiki page</a>.
    </div>
  </div>
  #(/edit)#

  <h1>Vocabulary Administration</h1>
  <p>
    Vocabularies can be used to produce a search navigation. A vocabulary must be created before content is indexed.
    The vocabulary is used to annotate the indexed content with a reference to the object that is denoted by the term of the vocabulary.
    The object can be denoted by a <abbr>URL</abbr> stub that, combined with the term, becomes the <abbr>URL</abbr> for the object.
  </p>

  <form action="Vocabulary_p.html" method="get" accept-charset="UTF-8">
    <fieldset>
      <legend>Vocabulary Selection</legend>
      <fieldset class="formSection">
        <legend>Name</legend>
        <div class="content">
          <select name="vocabulary" onchange="this.form.submit()">
            #{vocabularyset}#
            <option value="#[name]#" #(selected)#::selected="selected"#(/selected)#>#[name]#</option>
            #{/vocabularyset}#
          </select>
        </div>
      </fieldset>
      <fieldset class="formControl">
        <div class="content">
          <button type="submit" name="view" class="primary icon-run">View</button>
        </div>
      </fieldset>
    </fieldset>
  </form>

  #(create)#::
  <form action="Vocabulary_p.html" id="searchform" method="get" accept-charset="UTF-8" >
    <fieldset>
      <legend>Vocabulary Production</legend>
      <div class="description">
        <p>
          It is possible to produce a vocabulary out of the existing search index. This is done using a given <em>objectspace</em> which you can enter as a <abbr>URL</abbr> Stub.
          This stub is used to find all matching <abbr>URLs</abbr>. If the remaining path from the matching <abbr>URLs</abbr> then denotes a single file, the file name is used as vocabulary term.
          This works best with wikis. Try to use a wiki <abbr>URL</abbr> as objectspace path.
        </p>
      </div>
      <fieldset class="formSection">
        <legend>Name</legend>
        <div class="content">
          <input type="text" name="discovername" maxlength="128" />
        </div>
      </fieldset>
      <fieldset class="formSection">
        <legend>Objectspace</legend>
        <div class="content">
          <input type="text" name="discoverobjectspace" value="http://" maxlength="128" />
        </div>
      </fieldset>
      <fieldset class="formSection">
        <legend>Discover Terms</legend>
        <div class="content">
          <p>
            <input type="radio" name="discovermethod" value="none" checked="checked" id="noDiscover"/>
            <label for="noDiscover">no auto-discovery (empty vocabulary)</label>
          </p>
          <p>
            <input type="radio" name="discovermethod" value="path" id="fileNameDiscover"/>
            <label for="fileNameDiscover">from file name</label>
          </p>
          <p>
            <input type="radio" name="discovermethod" value="title" id="pageTitleDiscover"/>
            <label for="pageTitleDiscover">from page title</label>
          </p>
          <p>
            <input type="radio" name="discovermethod" value="titlesplitted" id="pageTitleSplitDiscover"/>
            <label for="pageTitleSplitDiscover">from page title (splitted)</label>
          </p>
          <p>
            <input type="radio" name="discovermethod" value="author" id="pageAuthorsDiscover"/>
            <label for="pageAuthorsDiscover">from page author</label>
          </p>
        </div>
      </fieldset>
      <fieldset class="formControl">
        <div class="content">
          <button type="submit" name="create" class="primary icon-run">Create</button>
        </div>
      </fieldset>
    </fieldset>
  </form>
  #(/create)#

  #(edit)#::
  <form action="Vocabulary_p.html" method="post" enctype="multipart/form-data" accept-charset="UTF-8">
    <fieldset><legend>Vocabulary Editor</legend>
      <dl>
        <dt>Vocabulary Name</dt><dd>#[name]#</dd>
        <dt>File</dt><dd>#(editable)#[automatically generated, not stored, cannot be edited]::#[file]##(/editable)#</dd>
        <dt>Size</dt><dd>#[size]#</dd>
        <dt>Namespace</dt><dd>#[namespace]#</dd>
        <dt>Predicate</dt><dd>#[predicate]#</dd>
        <dt>Prefix</dt><dd>#[prefix]#</dd>
        <dt>Objectspace</dt><dd>#(editable)##[objectspace]#::<input type="text" name="objectspace" value="#[objectspace]#" size="78" maxlength="128" /><br/>if set, uses the predicate <a href="#[objectspacepredicate]#" target="_blank">#[objectspacepredicate]#</a> for generated objects. Hint: use 'http://dbpedia.org/resource/' as default.#(/editable)#</dd>
      </dl>
      <p>This produces the following triples in the <a href="/interaction/GetRDF.xml?global=">triplestore</a> if a term or synonym matches in a document:</p>
      <dl>
        <dt>Triple #1</dt><dd>#[triple1]#</dd>
        <dt>Triple #2</dt><dd>#[triple2]#</dd>
        <dt>more Triples for linking into objectspace</dt><dd>#[tripleN]#</dd>
      </dl>
      <table class="sortable" border="0" cellpadding="2" cellspacing="1">
        <tr class="TableHeader" valign="bottom">
          <td>Modify</td>
          <td>Delete</td>
          <td>Literal</td>
          <td>Synonyms</td>
          <td>Object Link</td>
        </tr>
        #{terms}#
        <tr class="TableCell#(dark)#Light::Dark::Summary#(/dark)#">
          <td align="center">#(editable)#&nbsp;::<input type="checkbox" name="modify_#[term]#" id="modify_#[term]#" value="checked" disabled="disabled"/>#(/editable)#</td>
          <td align="center">#(editable)#&nbsp;::<input type="checkbox" name="delete_#[term]#" id="delete_#[term]#" value="checked" />#(/editable)#</td>
          <td align="left">#[term]#</td>
          <td align="left">#(editable)##[synonyms]#::<input type="text" name="synonyms_#[term]#" value="#[synonyms]#" size="40" maxlength="1024" onkeyup="document.getElementById('modify_#[term]#').checked='checked'; document.getElementById('modify_#[term]#').disabled=''; document.getElementById('delete_#[term]#').disabled='disabled';"/>#(/editable)#</td>
          <td align="left">#(editable)##[objectlink]#::<input type="text" name="objectlink_#[term]#" value="#[objectlink]#" size="60" maxlength="1024" onkeyup="document.getElementById('modify_#[term]#').checked='checked'; document.getElementById('modify_#[term]#').disabled=''; document.getElementById('delete_#[term]#').disabled='disabled';"/>#(/editable)#</td>
        </tr>
        #{/terms}#
        #(editable)#::
        <tr class="TableCellDark">
          <td align="center" colspan="2"><input type="checkbox" name="add_new" id="add_new" value="checked" disabled="disabled"/><i>add</i></td>
          <td align="left"><input type="text" name="newterm" id="newterm" size="24" maxlength="128" onkeyup="document.getElementById('add_new').checked='checked'; document.getElementById('add_new').disabled=''"/></td>
          <td align="left"><input type="text" name="newsynonyms" id="newsynonyms" size="40" maxlength="1024"/></td>
          <td align="left"><input type="text" name="newobjectlink" id="newobjectlink" size="60" maxlength="1024"/></td>
        </tr>
        <tr class="TableCellDark">
          <td colspan="3"></td>
          <td colspan="2" align="right" class="TableCellSummary"><input type="checkbox" name="clear_table" id="clear_table" value="checked" /><i>clear table (remove all terms)</i></td>
        </tr>
        <tr class="TableCellDark">
          <td colspan="3"></td>
          <td colspan="2" align="right" class="TableCellSummary"><input type="checkbox" name="delete_vocabulary" id="delete_vocabulary" value="checked" /><i>delete vocabulary</i></td>
        </tr>
        #(/editable)#
      </table>
      <input type="hidden" name="vocabulary" value="#[name]#" />
      <input type="submit" name="set" value="Submit" />
    </fieldset>
  </form>
  #(/edit)#

  #%env/templates/page-end.template%#
</body>
</html>
